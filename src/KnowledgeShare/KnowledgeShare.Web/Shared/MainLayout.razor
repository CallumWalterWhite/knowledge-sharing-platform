@using KnowledgeShare.Core.Posts
@inherits LayoutComponentBase
@inject ISearchPostService SearchPostService;

<PageTitle>MHR Knowledge sharing platform</PageTitle>
<RadzenLayout Style="grid-template-columns: 1fr auto; grid-template-areas: 'rz-header rz-sidebar' 'rz-body rz-sidebar'">
    <RadzenHeader>
        <RadzenStack Orientation="Orientation.Horizontal" JustifyContent="JustifyContent.End" AlignItems="AlignItems.Center">
            <div class="rz-text-align-center">
                <RadzenAutoComplete @bind-Value=@postTitle Data=@posts onclick="@OnClick" TextProperty="PostTitle" LoadData=@OnLoadData Style="width: 13rem" />
            </div>
            <LoginDisplay />
            <RadzenSidebarToggle Click="@(() => sidebar4Expanded = !sidebar4Expanded)" Class="rz-m-0" />
        </RadzenStack>
    </RadzenHeader>
    <RadzenSidebar @bind-Expanded="@sidebar4Expanded">
        <NavMenu />
    </RadzenSidebar>
    <RadzenBody>
        <div class="rz-p-4">
            @Body
        </div>
    </RadzenBody>
</RadzenLayout>
@code {
    bool sidebar4Expanded = false;
    string postTitle;

    IEnumerable<string> posts;

    IEnumerable<SearchPostResultDto> contextPosts = new List<SearchPostResultDto>();

    async Task OnLoadData(LoadDataArgs args)
    {
        contextPosts = await SearchPostService.SearchAsync(args.Filter.ToLower());
        posts = contextPosts.Select(x => x.Title);
    }
    
    async Task OnClick()
    {
    }
}